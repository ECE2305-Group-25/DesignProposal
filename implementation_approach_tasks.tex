\nchapter{Implementation, Approach, and Tasks}
\par Tasks in the project implementation will be classified from three different sections: Assembly, Electronics, and Software. Assembly tasks pertain to the construction of the physical dispenser. Electronics tasks involve the management, circuitry, and driving behind electronic components in the system. Software tasks include the processing of information, network communication, and interfacing between the system and the user.

\nsection{Assembly}
\par The primary structure of the dispenser will be a tall rectangular box to store up to six rolls of toilet paper on top of each other. Market Basket branded toilet paper rolls will be used in testing, each with a measured diameter and height of four inches. Using these dimensions for the prototype, the anticipated enclosure will not exceed 5x5x30 inches in size. This enclosure may be made from wood, plastic, or any other material that is sturdy and capable for mounting electrical components. The top and bottom of the enclosure will be open for loading and dispensing rolls. A hinge will be mounted on top of the enclosure to create a latch that may be opened to load rolls. Holes on the back of the enclosure will also be present to mount electrical components (see Figure 2).

\nsection{Electronics}
\par Due to the timing of the project, availability of purchasing electronic components is limited. Thus, the design for the dispenser (as shown in Figure 2) is comprised only of electronic components currently in possession of the team.

\par An infrared proximity sensor will be placed on the inside of the lid facing down at the interior of the enclosure. This sensor will be used to determine the capacity of rolls at a given time. The sensor itself has a dead zone of 10 centimeters, and will need to be accounted for during the enclosure's construction. Additionally, a lining of metal wire will be placed around the lid to detect if the lid is open at any given time. Sensing if the lid is open is crucial, as readings from the proximity sensor will be inaccurate while rolls are being loaded.

\par The dispensing mechanism will be comprised of four 5V servo motors split into two sets. The bottom set will be used to hold the bottom roll in place until it is dispensed. Upon receiving instruction to dispense, a platform between the servos will open downwards, allowing the roll to fall through the bottom of the enclosure. Extensive testing under various loads will be conducted to ensure that this system is implemented reliably. Due to the slow movement of the servo motor, there is evident concern that the platform will be unable to retract in time, causing multiple rolls to dispense at once. To overcome this, a second pair of servo motors will be placed to construct a platform directly above the first set. This platform will be used to hold the remaining rolls in place while the bottom roll is being dispensed. Once the first set is able to retract, the top platform will open downwards, allowing for the remaining rolls to fall into place. To better manage the servos simultaneously, they will be driven via a SunFounder PWM Servo Driver board. The 5V servos draw a considerable amount of current, and will require their own power supply. This power will be provided using the 5V peripheral pins of a PC power supply. 

\par All electronic components in the dispenser will be controlled by a Raspberry Pi computer. While the Raspberry Pi is capable of controlling electronic devices through its GPIO header pins, it also runs its own Linux based operating system, allowing it to easily process and serve data. Additionally, the Raspberry Pi is commonly used for prototyping IoT devices and applications. In 2015, the International Journal of Computer Networks and Applications published an article on the applicability the Pi has to IoT. The Raspberry Pi was tested on local networks for reliable data transfer and secure authentication while serving web content to devices. Communication between multiple devices locally was proven to be reliable for testing purposes, and was especially convenient to interface with electronic components \cite{raspberry_pi_iot}.
\par Both models of the Raspberry Pi computer in the team's possession have on-board Wi-Fi and are suited to wirelessly serve data to users. Due to the fact that the Raspberry Pi does not have a built-in ADC, an ADC circuit will also be constructed for the Raspberry Pi to properly read analog data from the IR proximity sensor. 

\nsection{Software}
\par Due to its simplicity and widespread support on the Rasbperry Pi, driving code for the dispenser will be written with the Python3 programming language. Code will need to be written to read converted data from the IR sensor. To determine the reliability of the proximity sensor data, code must also be written to check the status of the lid. After sensor data under various loads is recorded and analyzed, recordings will be used to abstract future recordings into physical counts for the remaining rolls in the dispenser. Utilizing the SunFounder PWM driver, existing libraries allow for easy control of the servos that power the dispensing mechanism. Dispensing times under a single roll load will be recorded to determine the length of time necessary for the bottom platform to safely retract. Once this is interval is obtained, it will be used as a delay for the top platform to release. Recordings will also be taken under two roll loads to determine the length of time for the top platform may safely retract.

\par To communicate with users, the Raspberry Pi will host a minimal webserver. This server will be responsible for sending reliable information with regards to the dispenser's status, as well as process user requests and use driver code to control the dispenser from user requests. To ensure the integrity of server code, a REST API will be defined with endpoints to implement. These endpoints will documented carefully, adhering to conventions followed from the "Rest API Design Rulebook" by Mark Massé. In addition to these conventions, Massé covers various platform architectures to which such APIs are implemented in. The webserver implemented will follow Massé's definition for a client-server architecture, to which the server retains full control of resources and is implemented independent of the client \cite{rest_api_rulebook}. This model is not only widely used in practice, but will also decrease the coupling of software related tasks. While API endpoints have yet to be formally defined, endpoints to retrieve dispenser capacity and request dispensing are currently planned to be implemented.

\par To complete the aforementioned client-server architecture of the TPaaS system, a client application will be implemented in the form of a mobile app. The client (as shown in Figure 2), will display the current capacity of rolls in the dispenser. Additionally, a button will be present for the user to press in order to dispense a new roll of toilet paper. This app will be built using React Native, a framework developed by Facebook that transforms JavaScript front-end code into native Android and iOS applications. For the purposes of the prototype, only an Android version of the client will be actively maintained. However, a web implementation of the client code may be ported to provide cross-platform capability.

\nfigure{TPaaS2.png}{Mockup of TPaaS system and mobile interface.}
